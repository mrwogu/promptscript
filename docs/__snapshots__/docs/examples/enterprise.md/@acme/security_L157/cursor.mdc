---
description: "Project-specific rules"
alwaysApply: true
---

You are working on Apply ACME security standards to all code..

Code style:
- Use OAuth 2.0 / OIDC
- MFA required (TOTP or WebAuthn)
- Session timeout: 3600 seconds
- Enable refresh token rotation
- RBAC with ABAC extensions
- Apply least privilege principle
- Audit logging required
- Encrypt at rest with AES-256
- Encrypt in transit with TLS 1.3
- Mask PII in all outputs
- Follow data classification for retention
- Daily vulnerability scanning
- Critical vulnerabilities block deployment
- High vulnerabilities: fix within 7 days
- Medium vulnerabilities: fix within 30 days
- Store in HashiCorp Vault
- Rotate every 90 days
- Never store secrets in code

Commands:
/threat-model - Help create a threat model
/vuln-check - Check for common vulnerabilities
/secure-code - Review code for security issues

Never:
- Never store passwords in plain text
- Never log sensitive data (passwords, tokens, PII)
- Never use MD5 or SHA1 for security purposes
- Never disable TLS certificate verification
- Never use eval() or similar unsafe functions
- Never trust user input without validation
- Never expose stack traces in production
- Always use parameterized queries (no SQL concatenation)
- Always validate and sanitize file uploads
- Always implement rate limiting for APIs
